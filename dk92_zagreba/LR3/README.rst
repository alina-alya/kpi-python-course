Использовал black для автоматического форматирования
Isort  для правильного висова импортов
Была переписана часть кода для лучшей читабельности или оптимизации. Подробнее в коментариях в самом коде.
